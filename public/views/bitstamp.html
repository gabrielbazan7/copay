<div class="topbar-container">
  <nav ng-controller="topbarController as topbar"
       class="tab-bar">
    <section class="left-small">
      <a class="p10"
         ng-click="topbar.goHome()">
        <span class="text-close">Close</span>
      </a>
    </section>

    <section class="right-small" ng-show="false">
      <a class="p10" href ui-sref="preferencesCoinbase">
        <i class="fi-widget size-24"></i>
      </a>
    </section>

    <section class="middle tab-bar-section">
      <h1 class="title ellipsis">
        Buy & Sell Bitcoin
      </h1>
    </section>
  </nav>
</div>

<div class="content coinbase" ng-controller="bitstampController" ng-init="init()">
  <div ng-show="!credentials">
    <div class="text-center m20v p20b">
      <img src="img/bitstamp-logo.png" width="200">
    </div>
    <div class="text-center small-10 small-centered columns m20t">
      <div class="text-center">
        <div class="text-left box-notification" ng-show="error">
          <div class="no-bullet m0 text-warning size-12">
            {{error}}
          </div>
        </div>
        <div>
          <label class="left">Customer ID</label>
          <input type="text" ng-model="customerID" ng-attr-placeholder="{{'Paste your customer ID here'}}">
          <label class="left">Api key</label>
          <input type="text" ng-model="apiKey" ng-attr-placeholder="{{'Paste your account API KEY here'}}">
          <button
            class="button expand round"
            ng-click="setCredentials(apiKey, customerID)"
            ng-disabled="!apiKey || !customerID"
            ng-style="{'background-color': '#384B5F'}" translate>
            Get started
          </button>
        </div>
      </div>
      <div>
        <div class="line-t size-10 text-gray m10b p10t">
          <span translate> To get an API key, go to "Account", "Security" and then "API Access". Set permissions and click "Generate key".</span>
            <a ng-click="$root.openExternalLink('https://www.bitstamp.net/account/security/api/')" translate> Click for searching API KEY</a>
        </div>
      </div>
    </div>
  </div>
  <div ng-show="credentials">
    <div class="text-center m20v">
      <img src="img/bitstamp-logo.png" width="100">
    </div>
    <ul class="no-bullet m0 size-12">
      <li class="line-b line-t p15 pointer"
        href ui-sref="buyBitstamp">
        <img src="img/buy-bitcoin.svg" alt="buy bitcoin" width="30">
        <span class="m10 text-normal text-bold">Buy Bitcoin</span>
        <span class="right text-gray">
          <i class="icon-arrow-right3 size-24 right"></i>
        </span>
      </li>
      <li class="line-b p15 pointer"
        href ui-sref="sellBitstamp">
        <img src="img/sell-bitcoin.svg" alt="sell bitcoin" width="30">
        <span class="m10 text-normal text-bold">Sell Bitcoin</span>
        <span class="right text-gray">
          <i class="icon-arrow-right3 size-24 right"></i>
        </span>
      </li>
    </ul>

    <div>
      <h4 class="title">Activity</h4>
      <div class="m20b box-notification">
        <ul class="no-bullet m0 text-warning size-12">
          <li ng-repeat="err in index.coinbasePendingError.errors" ng-bind-html="err.message"></li>
        </ul>
      </div>
      <div ng-repeat="(id, tx) in index.userTransactions | orderObjectBy:'updated_at':true track by $index"
        ng-click="coinbase.openTxModal(tx)"
        class="row collapse last-transactions-content">
        <div class="large-2 medium-2 small-2 columns">
          <img src="img/bought-pending.svg" alt="bought" width="24" ng-show="(tx.type == 'buy' || (tx.to && tx.type == 'send')) && tx.status != 'completed'">
          <img src="img/bought.svg" alt="bought" width="30" ng-show="(tx.type == 'buy' || (tx.to && tx.type == 'send')) && tx.status == 'completed'">
          <img src="img/sold-pending.svg" alt="sold" width="24" ng-show="tx.from && tx.type == 'send'">
          <img src="img/sold.svg" alt="sold" width="30" ng-show="!tx.from && tx.type == 'sell' && tx.status == 'completed'">
        </div>

        <div class="large-5 medium-5 small-5 columns">
          <div class="size-12 m5t">
            <span ng-show="tx.type == 'sell' && tx.status == 'completed'">Sold</span>
            <span ng-show="tx.type == 'buy' && tx.status == 'completed'">Bought</span>
            <span class="text-bold">
              <span ng-if="tx.type == 'sell' || (tx.type == 'send' && tx.from)">-</span>{{tx.amount.amount.replace('-','')}}
              {{tx.amount.currency}}
            </span>
          </div>
        </div>
        <div class="large-4 medium-4 small-4 columns text-right">
          <div ng-show="tx.error" class="m5t size-12 text-warning">
            Error
          </div>
          <div ng-show="!tx.error" class="m5t size-12 text-gray">
            <div ng-show="tx.status == 'completed'">
              <time ng-if="tx.created_at">{{tx.created_at | amTimeAgo}}</time>
            </div>
            <div ng-show="tx.status == 'pending'">
              <span class="label outline gray radius text-gray text-info" ng-if="tx.status == 'pending'">Pending</span>
            </div>
          </div>
        </div>
        <div class="large-1 medium-1 small-1 columns text-right">
          <i class="icon-arrow-right3 size-18"></i>
        </div>
      </div>
    </div>
  </div>
</div>
